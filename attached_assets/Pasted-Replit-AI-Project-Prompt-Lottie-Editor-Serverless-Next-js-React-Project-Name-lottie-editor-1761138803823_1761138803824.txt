Replit AI Project Prompt â€” Lottie Editor (Serverless Next.js + React)
ğŸ§© Project Name

lottie-editor-serverless

ğŸ“ Description

Build a full-featured Lottie animation editor using Next.js and React, entirely serverless (no Express, no custom Node servers).
The project must deploy directly to Vercel â€” all backend logic implemented as Next.js API routes.

The editor should allow users to:

Upload and manage Lottie JSON or ZIPs

Preview and scrub through animations

Edit layer colors and opacity

Apply global color palettes

Optimize and batch-process animations

Maintain session data serverlessly

âš™ï¸ Architecture Overview
1ï¸âƒ£ Stack

Frontend: React + Next.js pages

Backend: Next.js API routes (serverless)

Styling: Tailwind CSS or CSS Modules

Data: Stored temporarily in memory or /tmp

Optional persistence: Vercel KV or S3

Deployment: One-click deploy to Vercel (no custom server)

2ï¸âƒ£ Directory Structure
/pages
 â”œâ”€ index.js                â†’ Upload & Home page
 â”œâ”€ editor/[id].js          â†’ Lottie Editor UI
 â””â”€ api/
     â”œâ”€ upload.js
     â”œâ”€ batch.js
     â”œâ”€ health.js
     â”œâ”€ file/
     â”‚   â”œâ”€ [id].js
     â”‚   â”œâ”€ [id]/metadata.js
     â”‚   â”œâ”€ [id]/frame/[frame].js
     â”‚   â”œâ”€ [id]/edit-layer.js
     â”‚   â”œâ”€ [id]/apply-palette.js
     â”‚   â”œâ”€ [id]/optimize.js
     â”‚   â””â”€ [id]/export.js
     â””â”€ session/[sessionId]/files.js

ğŸ§  Functionalities & Flow (Detailed)
ğŸ—‚ï¸ 1. File Uploads & Import

Frontend

Drag-and-drop upload area (UploadArea component)

URL input field for remote JSON/ZIPs

Batch upload support (up to 25 files)

Displays metadata after upload (name, width, height, frame rate, etc.)

Backend â€” /api/upload

Accepts multipart/form-data or JSON body with file URLs

Validates JSON or ZIP (unzip and locate data.json)

Extracts metadata (layer count, frame count, width, height, framerate)

Temporarily stores files in /tmp or memory buffer

Returns array of uploaded files:

[
  {
    "id": "unique-file-id",
    "name": "animation.json",
    "frames": 120,
    "width": 512,
    "height": 512,
    "frameRate": 30
  }
]

ğŸ–¼ï¸ 2. Canvas / Preview

Frontend

Uses lottie-web or lottie-player for rendering

Play/pause buttons, frame slider, zoom/pan tools

Gridline toggle and snapping guides

Fetches Lottie data via /api/file/[id]

Backend

/api/file/[id] â†’ returns full Lottie JSON

/api/file/[id]/frame/[frame] â†’ returns frame snapshot (PNG or base64)

Implements optional caching for smoother scrubbing

ğŸ§© 3. Layer-Based Editing

Frontend

LayerPanel displays all layers with checkboxes or tree structure

Multi-select via Shift/Ctrl

Inputs to change color, stroke, or opacity

Undo/redo buttons

Backend â€” /api/file/[id]/edit-layer

{
  "layers": ["layer1", "layer3"],
  "properties": {
    "fillColor": "#FF0000",
    "strokeColor": "#00FF00",
    "opacity": 0.75
  }
}


Updates the corresponding layers in JSON

Shape layers â†’ update fill, stroke, opacity

Text layers â†’ update text/fill/stroke

Groups â†’ recursively update children

Saves updated Lottie JSON in temporary session memory

ğŸ¨ 4. Color Templates / Palette Application

Frontend

PalettePicker component with color swatches

Live preview of applied palette

Undo/redo support

Backend â€” /api/file/[id]/apply-palette

{
  "palette": {
    "primary": "#FF0000",
    "secondary": "#00FF00",
    "accent": "#0000FF"
  },
  "layers": ["all"]
}


Applies color scheme to all or selected layers

Stores palette in session memory

Optionally performs accessibility contrast check

âš¡ 5. Optimization Logic

Frontend

â€œOptimizeâ€ button on toolbar

Displays before/after stats (size, layer count, precision)

Option to download optimized JSON

Backend â€” /api/file/[id]/optimize

Flattens shape hierarchies

Removes hidden or empty layers

Rounds off keyframe precision

Compresses repeated assets

Returns optimization summary:

{
  "originalSize": 12345,
  "optimizedSize": 6789,
  "layersBefore": 10,
  "layersAfter": 6
}

ğŸ§® 6. Batch Operations

Frontend

BatchManager component to upload and manage multiple files

Batch apply palettes or optimizations with progress bars

Backend â€” /api/batch

Accepts array of file IDs and operation type

Processes in parallel (Promise.all)

Returns per-file results:

[
  { "fileId": "1", "status": "success", "optimizedSize": 45 },
  { "fileId": "2", "status": "error", "message": "Invalid Lottie JSON" }
]

ğŸ” 7. Session Management

Backend

Every user gets a temporary sessionId

All uploads, edits, palettes, and batch jobs are tied to that session

Storage options:

In-memory cache (default)

Vercel KV or Redis (optional)

S3 for persistent recovery

Endpoints

/api/session/[sessionId]/files â†’ list of userâ€™s files

/api/health â†’ { "status": "ok" }

ğŸ©º 8. Health Check Endpoint

Simple route: /api/health

Returns:

{ "status": "ok" }

ğŸ§± Frontend Structure
Pages
Page	Description
index.js	Upload interface and file list
editor/[id].js	Full-featured animation editor with canvas, layers, and palettes
Components
Component	Responsibility
UploadArea	Drag-and-drop + URL upload
Canvas	Lottie player + controls
LayerPanel	Layer tree + selection
PalettePicker	Palette management
BatchManager	Batch operations UI
ğŸ§© Backend Structure (Serverless API Routes)
pages/api/
 â”œâ”€ upload.js                â†’ Upload & metadata extraction
 â”œâ”€ batch.js                 â†’ Batch processing logic
 â”œâ”€ health.js                â†’ Health check
 â”œâ”€ file/
 â”‚  â”œâ”€ [id].js               â†’ Get Lottie JSON
 â”‚  â”œâ”€ [id]/metadata.js      â†’ Get metadata
 â”‚  â”œâ”€ [id]/frame/[frame].js â†’ Frame snapshot
 â”‚  â”œâ”€ [id]/edit-layer.js    â†’ Layer edits
 â”‚  â”œâ”€ [id]/apply-palette.js â†’ Apply palette
 â”‚  â”œâ”€ [id]/optimize.js      â†’ Optimize animation
 â”‚  â””â”€ [id]/export.js        â†’ Download/export JSON
 â””â”€ session/[sessionId]/files.js â†’ List session files

ğŸ§° Configuration
next.config.js
module.exports = {
  reactStrictMode: true,
  api: {
    bodyParser: {
      sizeLimit: '20mb',
    },
  },
};

package.json

Include:

"dependencies": {
  "next": "^14.0.0",
  "react": "^18.0.0",
  "react-dom": "^18.0.0",
  "lottie-web": "^5.12.0",
  "formidable": "^3.5.0",
  "adm-zip": "^0.5.10",
  "uuid": "^9.0.0"
}

ğŸ”„ Flow Summary

User uploads â†’ /api/upload â†’ returns file metadata

User selects file â†’ navigates to /editor/[id]

Canvas loads Lottie JSON â†’ from /api/file/[id]

User edits layers or applies palette â†’ API updates JSON in session

User optimizes or exports â†’ serverless functions process data

Batch mode â†’ /api/batch for multiple files

Session stored temporarily; persistent if configured

âœ… Deliverables

Replit AI should generate:

Next.js app with working pages and components

All serverless API routes as outlined

Basic UI scaffolding with Tailwind

Working upload, playback, editing, palette, optimization, batch flow

Ready for one-click deploy to Vercel